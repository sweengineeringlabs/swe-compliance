# Architecture: Reporting

**Version:** 1.0
**Status:** Draft
**Spec:** [Feature Spec](../1-requirements/reporting/reporting.spec)

## Components

| Component | Traces To | Description |
|-----------|-----------|-------------|
| FR-400 handler | STK-05 -> `core/reporter.rs` | Default output shall be human-readable text grouped by category, showing check ID, description, pass/fail/skip, violations with file paths, and a summary line. |
| FR-401 handler | STK-03 -> `core/reporter.rs` | When `--json` is provided, output shall be a JSON `ScanReport`. |
| FR-402 handler | STK-03 -> `main.rs` | Exit codes |
| FR-403 handler | STK-09 -> `main.rs` | When `--output` / `-o` is provided, the engine shall persist the scan report as JSON to the given file path, regardless of whether `--json` was specified for stdout. Parent directories are created automatically. Stdout output is unaffected. If the file cannot be written, the tool exits with code 2. |
| FR-831 handler | STK-09 -> `main.rs`, `core/reporter.rs` | When `--output <path>` is provided, the scan command shall serialize an `AuditStatusReport` as pretty-printed JSON. The report wraps `ScanReport` fields (promoted to top level) with ISO 15289:2019 clause 9.2 identification metadata: standard identifier, clause reference, tool name, tool version (from `Cargo.toml`), ISO 8601 UTC timestamp, and canonicalized project root path. The `--json` stdout output is unaffected and continues to emit the bare `ScanReport`. No new dependencies are introduced. |

## Related Documents

- [Feature Spec](../1-requirements/reporting/reporting.spec)
- [Test Plan](../5-testing/reporting/reporting.test)
- [Deployment](../6-deployment/reporting/reporting.deploy)

